<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Auto Copy</title>
</head>

<body
  id="page"
  style="margin:0; padding:0; background:white; width:100vw; height:100vh; cursor:pointer;"
>

<script>
  // -------------------------------------------
  // All code stored in frontend (no backend)
  // -------------------------------------------
  const programs = {
    2: `
package org.experiment2;

import org.apache.hadoop.io.*;
import org.apache.hadoop.mapreduce.Mapper; 
import java.io.IOException;

public class Matrix_Mapper extends Mapper<LongWritable, Text, Text, Text> {
    public void map(LongWritable key, Text value, Context context)
            throws IOException, InterruptedException {

        String[] parts = value.toString().split("\\s+"); 
        String matrix = parts[0];
        int i = Integer.parseInt(parts[1]); 
        int j = Integer.parseInt(parts[2]);
        double val = Double.parseDouble(parts[3]);

        int n = Integer.parseInt(context.getConfiguration().get("n"));
        int m = Integer.parseInt(context.getConfiguration().get("m"));

        if (matrix.equals("A")) {
            for (int k = 0; k < n; k++) {
                context.write(new Text(i + "," + k), new Text("A," + j + "," + val));
            }
        } else {
            for (int k = 0; k < m; k++) {
                context.write(new Text(k + "," + j), new Text("B," + i + "," + val));
            }
        }
    }
}
`,

    3: `
import org.apache.hadoop.io.IntWritable; 
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Reducer; 
import java.io.IOException;

public class WeatherReducer extends Reducer<IntWritable, Text, IntWritable, Text> {
    @Override
    public void reduce(IntWritable key, Iterable<Text> values, Context context)
            throws IOException, InterruptedException {
        String weatherCondition = null;
        for (Text val : values) {
            weatherCondition = val.toString();
        }
        context.write(key, new Text(weatherCondition));
    }
}
`,

    4: `
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper; 
import java.io.IOException;

public class TagMapper extends Mapper<Object, Text, Text, Text> { 
    private Text movieID = new Text();
    private Text tag = new Text();

    public void map(Object key, Text value, Context context)
            throws IOException, InterruptedException {

        String[] parts = value.toString().split("\\t");

        if (parts.length == 3) { 
            movieID.set(parts[0]); 
            tag.set(parts[1]); 
            context.write(movieID, tag);
        }
    }
}
`,

    8: `
package org.experiment8;

import java.io.IOException; 
import java.util.StringTokenizer;
import org.apache.hadoop.io.IntWritable; 
import org.apache.hadoop.io.LongWritable; 
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapred.MapReduceBase; 
import org.apache.hadoop.mapred.Mapper;
import org.apache.hadoop.mapred.OutputCollector; 
import org.apache.hadoop.mapred.Reporter;

public class WC_Mapper extends MapReduceBase 
        implements Mapper<LongWritable,Text,Text,IntWritable>{

    private final static IntWritable one = new IntWritable(1); 
    private Text word = new Text();

    public void map(LongWritable key, Text value,
                    OutputCollector<Text,IntWritable> output,
                    Reporter reporter) throws IOException {

        String line = value.toString();
        StringTokenizer tokenizer = new StringTokenizer(line);

        while (tokenizer.hasMoreTokens()){
            word.set(tokenizer.nextToken());
            output.collect(word, one);
        }
    }
}
`,
  };

  // -------------------------------------------
  // Read query parameter: ?code=3
  // -------------------------------------------
  const params = new URLSearchParams(window.location.search);
  const programNumber = params.get("code");

  async function autoCopy() {
    try {
      if (!programNumber || !programs[programNumber]) {
        document.getElementById("page").style.background = "#ffe8e8";
        return;
      }

      const content = programs[programNumber];

      await navigator.clipboard.writeText(content);

      // Green background on success
      document.getElementById("page").style.background = "#e8ffe8";
    } catch (err) {
      console.error(err);
      document.getElementById("page").style.background = "#ffe8e8";
    }
  }

  // Click anywhere to trigger
  document.body.addEventListener("click", autoCopy);
</script>

</body>
</html>
